# NestJS Test Task 1

## –ó–ê–î–ê–ß–ê

–†–∞–∑–≤–µ—Ä–Ω—É—Ç—å —Å–µ—Ä–≤–∏—Å –Ω–∞ **NestJS**, PostgreSQL, ClickHouse, NATS, Redis, Docker.

---

### ‚öôÔ∏è –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:

- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **NestJS** –≤ –∫–∞—á–µ—Å—Ç–≤–µ backend-—Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∞
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **PostgreSQL** –≤ –∫–∞—á–µ—Å—Ç–≤–µ –æ—Å–Ω–æ–≤–Ω–æ–π –ë–î
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **ClickHouse** –¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **NATS** –¥–ª—è –æ—á–µ—Ä–µ–¥–µ–π
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **Redis** –¥–ª—è –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **Docker** –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –≤—Å–µ–π —Å–∏—Å—Ç–µ–º—ã

---

### üì¶ –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö –∏ –º–∏–≥—Ä–∞—Ü–∏–∏

- –°–æ–∑–¥–∞—Ç—å —Ç–∞–±–ª–∏—Ü—É `goods` –∏ `projects` –≤ PostgreSQL
- –ü—Ä–æ—Å—Ç–∞–≤–∏—Ç—å **primary key** –∏ **–∏–Ω–¥–µ–∫—Å—ã** –Ω–∞ —É–∫–∞–∑–∞–Ω–Ω—ã–µ –ø–æ–ª—è
- –í –º–∏–≥—Ä–∞—Ü–∏—è—Ö PostgreSQL:
    - –î–ª—è `goods`:
        - `id = serial`
        - `priority` ‚Äî –∞–≤—Ç–æ–∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∏—Ä—É–µ–º—ã–π –æ—Ç max + 1
        - –ò–Ω–¥–µ–∫—Å –Ω–∞ `priority`
    - –î–ª—è `projects`:
        - `id = serial`
        - `name = string`
        - –ü—Ä–∏ –Ω–∞–∫–∞—Ç–∫–µ –º–∏–≥—Ä–∞—Ü–∏–π ‚Äî –¥–æ–±–∞–≤–∏—Ç—å –æ–¥–Ω—É –∑–∞–ø–∏—Å—å –≤ —Ç–∞–±–ª–∏—Ü—É `projects`:
            - `id = 1`
            - `name = '–ü–µ—Ä–≤–∞—è –∑–∞–ø–∏—Å—å'`

---

### ‚úèÔ∏è CRUD –º–µ—Ç–æ–¥—ã (—Ç–∞–±–ª–∏—Ü–∞ GOODS)

–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å REST API:

| –ú–µ—Ç–æ–¥  | –û–ø–∏—Å–∞–Ω–∏–µ                         |
|--------|----------------------------------|
| GET    | –ü–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –ø–æ ID            |
| POST   | –°–æ–∑–¥–∞—Ç—å –∑–∞–ø–∏—Å—å                   |
| PATCH  | –û–±–Ω–æ–≤–∏—Ç—å –∑–∞–ø–∏—Å—å –ø–æ ID            |
| DELETE | –£–¥–∞–ª–∏—Ç—å –∑–∞–ø–∏—Å—å –ø–æ ID             |

---

### üß† –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

- –ü—Ä–∏ **—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ –¥–∞–Ω–Ω—ã—Ö**:
    - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **—Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏**
    - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `SELECT FOR UPDATE`
    - –í–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª—è
    - –ò–Ω–≤–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å –∫–µ—à –≤ Redis
- –ü—Ä–∏ **—É–¥–∞–ª–µ–Ω–∏–∏ –∏–ª–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏** –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π –∑–∞–ø–∏—Å–∏:
    - –í–µ—Ä–Ω—É—Ç—å —Å—Ç–∞—Ç—É—Å **404**
    - –§–æ—Ä–º–∞—Ç –æ—à–∏–±–∫–∏:
      ```json
      {
        "code": 3,
        "message": "errors.common.notFound",
        "details": {}
      }
      ```
- –ü—Ä–∏ **GET**:
    - –ü—ã—Ç–∞–µ–º—Å—è –ø–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –∏–∑ Redis
    - –ï—Å–ª–∏ –Ω–µ—Ç ‚Äî –±–µ—Ä–µ–º –∏–∑ PostgreSQL –∏ –∫–ª–∞–¥–µ–º –≤ Redis –Ω–∞ **60 —Å–µ–∫—É–Ω–¥**
- –ü—Ä–∏ **POST/PATCH/DELETE**:
    - –ü–∏—à–µ–º –ª–æ–≥ –≤ **ClickHouse** —á–µ—Ä–µ–∑ **–æ—á–µ—Ä–µ–¥—å NATS**
    - –õ–æ–≥–∏ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –ø–∞—á–∫–∞–º–∏

---

### üíæ ClickHouse –ª–æ–≥–∏

–ü—Ä–∏ –∫–∞–∂–¥–æ–º –∏–∑–º–µ–Ω–µ–Ω–∏–∏:

```json
{
  "timestamp": "2024-01-01T12:00:00Z",
  "operation": "CREATE" | "UPDATE" | "DELETE",
  "entity": "goods",
  "entity_id": 5,
  "data": { ... }
}
